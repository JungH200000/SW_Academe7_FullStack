<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Post Edit Form</title>

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Latest compiled and minified CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Latest compiled JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <style>
        .form, .form-group{
            display:flex;
            flex-direction:column;
            gap:10px;
        }

    </style>
</head>
<body>
<div class="container py-4">
    <h1 class="text-center my-3">Post Edit Form</h1>

    <!--파일업로드시 주의사항
                [1] form method는 post로 지정
                [2] form enctype을 multipart/form-data 로 지정해야 한다
                파일데이터를 서버에 전송하기 위한 설정
                [3] 해당 컨트롤러에서는 첨부파일(input type="file)의 input name (우리는 file라고 줌)
                과 동일한 이름의 파라미터를 MultipartFile타입으로 받아야 한다
                [4] application.yml 에 파일 업로드 관련 설정 등록
                [5] 실제 업로드된 경로와 웹에서 참조할 경로를 매핑
                -->
    <div th:if="${dto==null}"
            class="alert alert-primary col-auto" style="max-width:900px">
        <h3>해당 글은 존재하지 않습니다</h3>
    </div>

    <div th:unless="${dto==null}" class="col-8 offset-2">
        <form method="post"  enctype="multipart/form-data" action="/posts" class="form">
            <!--  hidden data mode 값. 글쓰기 :write, 글수정: edit           -->
            <input type="hidden" name="mode" value="edit">
            <!--            mode값은 edit-->
            <input type="hidden" name="id" th:value="${dto.id}">
            <input type="hidden" name="old_attach" th:value="${old_attach}">
            <!--            글번호와 예전 첨부했던 파일명을 hidden으로 넘기지-->
            <!--  -----------------------------------           -->
            <div class="form-group">
                <label for="name" class="label">작성자</label>
                <input type="text" id="name" name="name"
                       th:value="${dto.name}"
                       required placeholder="작성자" class="form-control">
            </div>

            <div class="form-group">
                <label for="title" class="label">제 목</label>
                <input type="text" id="title" name="title"
                       th:value="${dto.title}"
                       required placeholder="글제목" class="form-control">
            </div>

            <div class="form-group">
                <label for="content" class="label">글내용</label>
                <textarea id="content" name="content" rows="7"
                          th:text="${dto.content}"
                          required placeholder="글내용" class="form-control"></textarea>
            </div>
            <div class="form-group" th:if="${old_attach!=null}">
                <img th:src="@{'/uploads/'+${old_attach}}" style="width:200px" class="img-thumbnail">
            </div>
            <div class="form-group">
                <label class="label" for="image">이미지 업로드</label>
                <input type="file" id="image" name="file" class="form-control" accept="image/*">
            </div>
            <div class="input-btn my-2 text-center">
                <button class="btn btn-primary">수정하기</button>
                <button class="btn btn-secondary" type="reset">다시쓰기</button>
            </div>
        </form>
    </div>
</div>
</body>
</html>